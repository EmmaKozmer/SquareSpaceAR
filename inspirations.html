<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inspirations - My Square Space</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="inspirations-container">
        <a href="index.html" class="back-button-inspirations">&#8592;</a>
        <h1>Inspirations.</h1>
        <p class="intro-text">
            Below you can find some inspirations for your next interior design project. Enjoy!
        </p>
        <div class="upload-bar">
            <input type="file" id="imageUpload" accept="image/*" style="display:none;">
            <label for="imageUpload" class="upload-button">Upload Image</label>
        </div>
        <div class="filter-bar">
            <button onclick="filterImages('all')">Show All</button>
            <button onclick="filterImages('donator')">Donator Lounge</button>
            <button onclick="filterImages('tea')">Tea Room</button>
            <button onclick="filterImages('workspace')">Workspaces</button>
        </div>
        <div class="gallery-container">
            <div class="gallery-item" data-category="tea">
                <img src="../images/cafeteria1.jpg" alt="Inspiration 1" class="image">
                <div class="star-icon" onclick="toggleFavorite(event, 'cafeteria1.jpg')">&#9733;</div>
            </div>
            <div class="gallery-item" data-category="tea">
                <img src="../images/cafeteria2.jpg" alt="Inspiration 2" class="image">
                <div class="star-icon" onclick="toggleFavorite(event, 'cafeteria2.jpg')">&#9733;</div>
            </div>
            <div class="gallery-item" data-category="donator">
                <img src="../images/donator.jpg" alt="Inspiration 3" class="image">
                <div class="star-icon" onclick="toggleFavorite(event, 'donator.jpg')">&#9733;</div>
            </div>
            <div class="gallery-item" data-category="workspace">
                <img src="../images/room1.jpg" alt="Inspiration 4" class="image">
                <div class="star-icon" onclick="toggleFavorite(event, 'room1.jpg')">&#9733;</div>
            </div>
            <div class="gallery-item" data-category="workspace">
                <img src="../images/room2.jpg" alt="Inspiration 5" class="image">
                <div class="star-icon" onclick="toggleFavorite(event, 'room2.jpg')">&#9733;</div>
            </div>
            <div class="gallery-item" data-category="workspace">
                <img src="../images/study2.jpg" alt="Inspiration 6" class="image">
                <div class="star-icon" onclick="toggleFavorite(event, 'study2.jpg')">&#9733;</div>
            </div>
            <div class="gallery-item" data-category="workspace">
                <img src="../images/study3.jpg" alt="Inspiration 7" class="image">
                <div class="star-icon" onclick="toggleFavorite(event, 'study3.jpg')">&#9733;</div>
            </div>
        </div>
        <div id="myModal" class="modal">
            <span class="close">&times;</span>
            <img class="modal-content" id="img01">
            <div id="caption"></div>
        </div>
    </div>
    <script src="js/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            updateStarStatus();            
            loadImagesFromLocalStorage(); 
            filterImages('all');          
            if (localStorage.getItem('triggerUpload') === 'true') {
                document.getElementById('imageUpload').click();
                localStorage.removeItem('triggerUpload');
            }
        });
        
        var modal = document.getElementById('myModal');
        var modalImg = document.getElementById('img01');
        var captionText = document.getElementById('caption');
        var span = document.getElementsByClassName('close')[0];
        var fileInput = document.getElementById('imageUpload');
        
        span.onclick = function() {
            modal.style.display = 'none';
        };
        
        function toggleFavorite(event, imageName) {
            event.stopPropagation();
            var star = event.target;
            var favorites = JSON.parse(localStorage.getItem('favorites')) || {};
        
            var img = star.parentNode.querySelector('img');
            var imageKey = imageName || img.src.split('/').pop(); 
        
            if (favorites[imageKey]) {
                delete favorites[imageKey];
                star.classList.remove('favorited');
                star.innerHTML = '&#9734;'; 
            } else {
                favorites[imageKey] = true;
                star.classList.add('favorited');
                star.innerHTML = '&#9733;'; 
            }
        
            localStorage.setItem('favorites', JSON.stringify(favorites));
        }
        
        function updateStarStatus() {
            var favorites = JSON.parse(localStorage.getItem('favorites')) || {};
            document.querySelectorAll('.gallery-item .star-icon').forEach(star => {
                var img = star.parentNode.querySelector('img');
                var imageKey = img.alt || img.src.split('/').pop();
                if (favorites[imageKey]) {
                    star.classList.add('favorited');
                    star.innerHTML = '&#9733;';
                } else {
                    star.classList.remove('favorited');
                    star.innerHTML = '&#9734;'; 
                }
            });
        }
        
        function filterImages(category) {
            var images = document.querySelectorAll('.gallery-item');
            images.forEach(image => {
                image.style.display = (category === 'all' || image.dataset.category === category) ? 'inline-block' : 'none';
            });
        }
        
        function addImageToGallery() {
            var file = fileInput.files[0]; 
            if (file && file.type.startsWith('image/')) {
                var reader = new FileReader();
                reader.onload = function(e) {
                    var newImageName = 'uploaded_' + Date.now(); 
                    saveImageToLocalStorage(e.target.result, newImageName);
                    addNewImageToGallery(e.target.result, newImageName);
                };
                reader.readAsDataURL(file);
            } else {
                alert('Please select an image file.');
            }
        }

        fileInput.addEventListener('change', addImageToGallery);

        
        function saveImageToLocalStorage(data, name) {
            var images = JSON.parse(localStorage.getItem('galleryImages')) || {};
            images[name] = data;
            localStorage.setItem('galleryImages', JSON.stringify(images));
        }
        
        function addNewImageToGallery(src, imageName) {
            var galleryContainer = document.querySelector('.gallery-container');
            var imgElement = document.createElement('img');
            imgElement.src = src;
            imgElement.alt = imageName;
            imgElement.className = 'image';
        
            var divElement = document.createElement('div');
            divElement.className = 'gallery-item';
            divElement.appendChild(imgElement);
        
            var starIcon = document.createElement('div');
            starIcon.className = 'star-icon';
            starIcon.innerHTML = '&#9734;'; 
            starIcon.onclick = function(event) {
                toggleFavorite(event, imageName);
            };
            divElement.appendChild(starIcon);
        
            galleryContainer.appendChild(divElement);
        
            imgElement.onclick = function() {
                modal.style.display = 'block';
                modalImg.src = this.src;
                captionText.innerHTML = this.alt;
            };
        }
    </script>
</body>
</html>